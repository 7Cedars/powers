<!DOCTYPE html>
<html>
<head>
    <title>GitHub Commits API Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-group { margin: 10px 0; }
        label { display: inline-block; width: 100px; }
        input { width: 300px; padding: 5px; }
        button { padding: 10px 20px; margin: 10px 5px; }
        .result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; background: #f9f9f9; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>GitHub Commits API Test</h1>
    
    <div class="form-group">
        <label>Repository:</label>
        <input type="text" id="repo" placeholder="owner/repo (e.g., 7Cedars/powers)" value="7Cedars/powers">
    </div>
    
    <div class="form-group">
        <label>Path:</label>
        <input type="text" id="path" placeholder="folder/path (e.g., frontend/components)" value="frontend/components">
    </div>
    
    <div class="form-group">
        <label>Author:</label>
        <input type="text" id="author" placeholder="GitHub username" value="teijehidde">
    </div>
    
    <div>
        <button onclick="testGet()">Test GET Request</button>
        <button onclick="testPost()">Test POST Request</button>
    </div>
    
    <div id="result" class="result" style="display: none;"></div>

    <script>
        async function testGet() {
            const repo = document.getElementById('repo').value;
            const path = document.getElementById('path').value;
            const author = document.getElementById('author').value;
            
            const url = `/api/github-commits?repo=${encodeURIComponent(repo)}&path=${encodeURIComponent(path)}&author=${encodeURIComponent(author)}`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                displayResult(data, response.ok);
            } catch (error) {
                displayResult({ error: error.message }, false);
            }
        }
        
        async function testPost() {
            const repo = document.getElementById('repo').value;
            const path = document.getElementById('path').value;
            const author = document.getElementById('author').value;
            
            try {
                const response = await fetch('/api/github-commits', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ repo, path, author })
                });
                const data = await response.json();
                displayResult(data, response.ok);
            } catch (error) {
                displayResult({ error: error.message }, false);
            }
        }
        
        function displayResult(data, success) {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result ' + (success ? 'success' : 'error');
            resultDiv.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        }
    </script>
</body>
</html>
